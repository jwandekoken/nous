# =============================================================================
# Internal Static File Server for Vue.js SPA
# =============================================================================
# This serves the built frontend assets on port 80 (internal only).
# An external reverse proxy (bundled or BYO) handles SSL and API routing.
#
# Why Caddy here? Vue Router uses client-side routing. Without try_files,
# refreshing on /memories/123 would return 404. This Caddyfile handles:
#   - SPA fallback routing (all paths -> index.html)
#   - Gzip compression for assets
#   - Health endpoint for container orchestration
# =============================================================================

:80 {
    root * /srv
    encode gzip

    # Health endpoint for Docker health checks
    handle /health {
        respond "OK" 200
    }

    # SPA fallback - serve index.html for client-side routing
    handle {
        try_files {path} /index.html
        file_server
    }
}
